<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h3>Channels</h3>
            <div id="channelList" class="channel-list"></div>
            <button id="createChannelBtn" class="create-channel-btn">+ Create Channel</button>
            <hr>
            <h3>Search</h3>
            <button id="searchBtn" class="search-btn">ğŸ” Search Messages</button>
            <hr>
            <h3>Connected Users</h3>
            <div id="userCount" class="user-count">Loading...</div>
            <ul id="userList"></ul>
            <button id="leaveBtn" class="leave-btn">Leave Chat</button>
        </div>
        <div class="chat-area">
            <div id="chatHistory" class="chat-history">
                <div class="system-message">Connecting to chat server...</div>
            </div>
            <div id="typingIndicator" class="typing-indicator"></div>
            <div id="replyBanner" class="reply-banner hidden">
                <span class="reply-text">Replying to <strong id="replyToUsername"></strong></span>
                <button type="button" class="cancel-reply" onclick="cancelReply()">âœ•</button>
            </div>
            <form id="chatForm" class="chat-form">
                <input type="hidden" id="replyTo" value="">
                <div class="chat-input-wrapper">
                    <label for="fileInput" class="file-input-label">
                        ğŸ“
                    </label>
                    <input type="file" id="fileInput" accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.txt,.zip,.rar" multiple>
                    <div id="filePreview" class="file-preview hidden"></div>
                    <input type="text" id="message" placeholder="Type a message..." autocomplete="off">
                    <button type="submit">Send</button>
                </div>
            </form>
        </div>
    </div>
    <div id="imageModal" class="image-modal hidden" onclick="closeImageModal()">
        <span class="image-modal-close">&times;</span>
        <img id="imageModalImg" src="" alt="Full size">
    </div>
    <div id="editModal" class="edit-modal hidden" onclick="if(event.target.id === 'editModal') closeEditModal()">
        <div class="edit-modal-content" onclick="event.stopPropagation()">
            <h3>Edit Message</h3>
            <textarea id="editMessageInput" rows="4"></textarea>
            <div class="edit-modal-actions">
                <button type="button" class="cancel-edit" onclick="closeEditModal()">Cancel</button>
                <button type="button" class="save-edit" onclick="saveEdit()">Save</button>
            </div>
        </div>
    </div>
    <div id="createChannelModal" class="edit-modal hidden" onclick="if(event.target.id === 'createChannelModal') closeCreateChannelModal()">
        <div class="edit-modal-content" onclick="event.stopPropagation()">
            <h3>Create Channel</h3>
            <input type="text" id="newChannelName" placeholder="Channel name" maxlength="30">
            <div class="edit-modal-actions">
                <button type="button" class="cancel-edit" onclick="closeCreateChannelModal()">Cancel</button>
                <button type="button" class="save-edit" onclick="createChannel()">Create</button>
            </div>
        </div>
    </div>
    <div id="searchModal" class="edit-modal hidden" onclick="if(event.target.id === 'searchModal') closeSearchModal()">
        <div class="search-modal-content" onclick="event.stopPropagation()">
            <h3>Search Messages</h3>
            <div class="search-form">
                <input type="text" id="searchQuery" placeholder="Search text...">
                <input type="text" id="searchUsername" placeholder="Search by username...">
                <select id="searchChannelId">
                    <option value="all">All Channels</option>
                </select>
                <div class="date-inputs">
                    <div>
                        <label>From:</label>
                        <input type="date" id="searchStartDate">
                    </div>
                    <div>
                        <label>To:</label>
                        <input type="date" id="searchEndDate">
                    </div>
                </div>
                <button type="button" class="search-submit-btn" onclick="performSearch()">Search</button>
            </div>
            <div id="searchResults" class="search-results"></div>
            <div class="edit-modal-actions">
                <button type="button" class="cancel-edit" onclick="closeSearchModal()">Close</button>
            </div>
        </div>
    </div>
    <script src="chat.js"></script>
</body>
</html>
