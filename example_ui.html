<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Clone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom Scrollbar Styles to match Discord's look */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
            background-color: #2B2D31;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #1A1B1E;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background-color: #2B2D31;
        }
        /* Utility for hiding scrollbar but keeping functionality */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-[#313338] text-white font-sans overflow-hidden select-none">

    <div id="app" class="flex h-screen w-full">
        <!-- 1. Channel Sidebar -->
        <div class="w-60 bg-[#2B2D31] flex flex-col min-w-[240px]">
            <!-- Server Header -->
            <div class="h-12 px-4 flex items-center justify-between shadow-sm hover:bg-[#35373C] cursor-pointer transition-colors border-b border-[#1f2023]">
                <h1 class="font-bold text-[15px] truncate">React Developers</h1>
                <i data-lucide="settings" class="w-4 h-4"></i>
            </div>

            <!-- Channels List -->
            <div class="flex-1 overflow-y-auto custom-scrollbar py-3" id="channels-container">
                <!-- Channels injected by JS -->
            </div>

            <!-- User Control Panel -->
            <div class="bg-[#232428] px-2 py-1.5 flex items-center">
                <div class="flex items-center p-1 hover:bg-[#3F4147] rounded cursor-pointer mr-auto group">
                    <div class="relative mr-2">
                        <img src="https://ui-avatars.com/api/?name=You&background=random" class="w-8 h-8 rounded-full" alt="Me">
                        <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-[#232428] rounded-full"></div>
                    </div>
                    <div class="text-sm">
                        <div class="font-semibold text-white text-[13px] leading-tight">You</div>
                        <div class="text-[11px] text-[#949BA4]">#1234</div>
                    </div>
                </div>
                <div class="flex items-center">
                    <button class="p-1.5 hover:bg-[#3F4147] rounded text-[#dbdee1]">
                        <i data-lucide="settings" class="w-[19px] h-[19px]"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 2. Main Chat Area -->
        <div class="flex-1 flex flex-col min-w-0 bg-[#313338]">
            <!-- Chat Header -->
            <header class="h-12 px-4 flex items-center shadow-sm border-b border-[#26272D] flex-shrink-0 justify-between">
                <div class="flex items-center overflow-hidden">
                    <i data-lucide="hash" class="text-[#80848E] mr-2 w-6 h-6"></i>
                    <h3 id="header-channel-name" class="font-bold text-white mr-4 whitespace-nowrap">general</h3>
                    <span id="header-topic" class="hidden md:block text-xs text-[#949BA4] truncate border-l border-[#3F4147] pl-4">Let's talk about React 19! ‚öõÔ∏è</span>
                </div>
                
                <div class="flex items-center space-x-3 text-[#B5BAC1]">
                    <i id="toggle-members-btn" data-lucide="users" class="w-6 h-6 hover:text-[#dbdee1] cursor-pointer text-white"></i>
                    <div class="relative hidden sm:block">
                        <input type="text" placeholder="Search" class="bg-[#1E1F22] text-[#dbdee1] text-xs rounded px-2 py-1 pl-2 w-36 transition-all focus:w-60 focus:outline-none">
                        <i data-lucide="search" class="absolute right-2 top-1.5 text-[#949BA4] w-[14px] h-[14px]"></i>
                    </div>
                    <i data-lucide="inbox" class="w-6 h-6 hover:text-[#dbdee1] cursor-pointer"></i>
                </div>
            </header>

            <!-- Message List -->
            <main id="messages-container" class="flex-1 overflow-y-auto custom-scrollbar flex flex-col px-4 pt-4">
                <!-- Messages injected by JS -->
            </main>

            <!-- Input Area -->
            <div class="px-4 pb-6 bg-[#313338] pt-2 flex-shrink-0">
                <div class="bg-[#383A40] rounded-lg px-4 py-2.5 flex items-center">
                    <button class="bg-[#B5BAC1] text-[#313338] rounded-full p-0.5 mr-3 hover:text-white transition-colors flex items-center justify-center">
                        <i data-lucide="plus" class="w-4 h-4 font-bold"></i>
                    </button>
                    <form id="message-form" class="flex-1">
                        <input type="text" id="message-input" placeholder="Message #general" class="bg-transparent text-[#dbdee1] w-full focus:outline-none placeholder-[#949BA4]" autocomplete="off">
                    </form>
                    <div class="flex items-center space-x-3 text-[#B5BAC1]">
                        <i data-lucide="sticker" class="w-6 h-6 hover:text-[#dbdee1] cursor-pointer"></i>
                        <i data-lucide="smile" class="w-6 h-6 hover:text-[#dbdee1] cursor-pointer"></i>
                    </div>
                </div>
                <!-- Typing Indicator Mock -->
                <div id="typing-indicator" class="h-6 mt-1 flex items-center hidden">
                    <div class="flex space-x-1 animate-pulse">
                        <div class="w-1.5 h-1.5 bg-[#dbdee1] rounded-full"></div>
                        <div class="w-1.5 h-1.5 bg-[#dbdee1] rounded-full"></div>
                        <div class="w-1.5 h-1.5 bg-[#dbdee1] rounded-full"></div>
                    </div>
                    <span class="text-xs text-[#dbdee1] font-bold ml-2">Someone</span>
                    <span class="text-xs text-[#949BA4] ml-1">is typing...</span>
                </div>
            </div>
        </div>

        <!-- 3. Members Sidebar -->
        <aside id="members-sidebar" class="w-[240px] bg-[#2B2D31] hidden lg:flex flex-col overflow-y-auto custom-scrollbar p-3 min-w-[240px]">
            <!-- Members injected by JS -->
        </aside>

    </div>

    <script>
        // --- Data ---
        const CHANNELS = [
            { id: 'c1', name: 'general', type: 'text' },
            { id: 'c2', name: 'announcements', type: 'text' },
            { id: 'c3', name: 'help-react', type: 'text' },
            { id: 'c4', name: 'showcase', type: 'text' },
        ];

        const INITIAL_MESSAGES = {
            'c1': [
                { id: 1, user: 'Dan Abramov', avatar: 'https://randomuser.me/api/portraits/men/32.jpg', content: 'Just released a new hook pattern. Thoughts?', timestamp: 'Today at 10:30 AM', role: 'Admin' },
                { id: 2, user: 'Sophie Alpert', avatar: 'https://randomuser.me/api/portraits/women/44.jpg', content: 'Looks clean! The dependency array logic is much simpler now.', timestamp: 'Today at 10:32 AM', role: 'Moderator' },
                { id: 3, user: 'Junior Dev', avatar: 'https://randomuser.me/api/portraits/men/85.jpg', content: 'I am still struggling with useEffect üò≠', timestamp: 'Today at 10:35 AM', role: 'Member' },
            ],
            'c2': [
                { id: 1, user: 'System', avatar: null, content: 'Welcome to the server!', timestamp: 'Yesterday', role: 'Bot' }
            ],
            'c3': [],
            'c4': []
        };

        const MEMBERS = [
            { id: 1, name: 'Dan Abramov', avatar: 'https://randomuser.me/api/portraits/men/32.jpg', status: 'online', role: 'Admin', activity: 'VS Code' },
            { id: 2, name: 'Sophie Alpert', avatar: 'https://randomuser.me/api/portraits/women/44.jpg', status: 'online', role: 'Moderator', activity: null },
            { id: 3, user: 'Ryan Florence', avatar: 'https://randomuser.me/api/portraits/men/22.jpg', status: 'online', role: 'Admin', activity: 'Remixing things' },
            { id: 4, name: 'Junior Dev', avatar: 'https://randomuser.me/api/portraits/men/85.jpg', status: 'online', role: 'Member', activity: 'Playing League of Legends' },
            { id: 5, name: 'Designer One', avatar: 'https://randomuser.me/api/portraits/women/65.jpg', status: 'offline', role: 'Member', activity: null },
        ];

        // --- State ---
        let state = {
            activeChannelId: 'c1',
            messages: JSON.parse(JSON.stringify(INITIAL_MESSAGES)), // Deep copy
            showUserList: true
        };

        // --- DOM Elements ---
        const channelsContainer = document.getElementById('channels-container');
        const messagesContainer = document.getElementById('messages-container');
        const messageForm = document.getElementById('message-form');
        const messageInput = document.getElementById('message-input');
        const headerChannelName = document.getElementById('header-channel-name');
        const headerTopic = document.getElementById('header-topic');
        const membersSidebar = document.getElementById('members-sidebar');
        const toggleMembersBtn = document.getElementById('toggle-members-btn');
        const typingIndicator = document.getElementById('typing-indicator');

        // --- Rendering Functions ---

        function renderChannels() {
            channelsContainer.innerHTML = '';
            
            // Add margin wrapper
            const wrapper = document.createElement('div');
            wrapper.className = 'mt-2';

            CHANNELS.forEach(channel => {
                const isActive = state.activeChannelId === channel.id;
                const el = document.createElement('div');
                el.className = `flex items-center mx-2 px-2 py-[6px] rounded-[4px] cursor-pointer group mb-[2px] ${isActive ? 'bg-[#404249] text-white' : 'text-[#949BA4] hover:bg-[#35373C] hover:text-[#dbdee1]'}`;
                el.onclick = () => setActiveChannel(channel.id);
                
                el.innerHTML = `
                    <i data-lucide="hash" class="mr-1.5 w-5 h-5 text-[#80848E]"></i>
                    <span class="font-medium truncate ${isActive ? 'text-white' : ''}">${channel.name}</span>
                    <div class="ml-auto hidden group-hover:flex">
                         <i data-lucide="settings" class="w-[14px] h-[14px] hover:text-white"></i>
                    </div>
                `;
                wrapper.appendChild(el);
            });
            channelsContainer.appendChild(wrapper);
        }

        function renderMembers() {
            membersSidebar.innerHTML = '';
            
            const onlineUsers = MEMBERS.filter(u => u.status !== 'offline');
            const offlineUsers = MEMBERS.filter(u => u.status === 'offline');

            const renderGroup = (title, users) => {
                if (users.length === 0) return '';
                
                let html = `<div class="mb-6"><h3 class="text-[#949BA4] text-xs font-bold uppercase mb-2 px-2">${title} ‚Äî ${users.length}</h3>`;
                
                users.forEach(user => {
                    html += `
                        <div class="flex items-center px-2 py-1.5 rounded hover:bg-[#35373C] cursor-pointer group opacity-90 hover:opacity-100">
                            <div class="relative mr-3">
                                <img src="${user.avatar || `https://ui-avatars.com/api/?name=${user.name}`}" alt="${user.name}" class="w-8 h-8 rounded-full">
                                <div class="absolute bottom-0 right-0 w-3.5 h-3.5 border-[3px] border-[#2B2D31] rounded-full ${user.status === 'online' ? 'bg-green-500' : 'bg-gray-500'}"></div>
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="text-[15px] font-medium leading-4 text-[#dbdee1]">
                                    ${user.name}
                                </div>
                                ${user.activity ? `<div class="text-xs text-[#949BA4] truncate mt-0.5">${user.activity}</div>` : ''}
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                return html;
            };

            membersSidebar.innerHTML = renderGroup('Online', onlineUsers) + renderGroup('Offline', offlineUsers);
        }

        function renderMessages() {
            const msgs = state.messages[state.activeChannelId] || [];
            
            if (msgs.length === 0) {
                const channelName = CHANNELS.find(c => c.id === state.activeChannelId).name;
                messagesContainer.innerHTML = `
                    <div class="mt-auto mb-6">
                        <div class="h-16 w-16 bg-[#41434A] rounded-full flex items-center justify-center mb-4">
                            <i data-lucide="hash" class="w-10 h-10 text-white"></i>
                        </div>
                        <h1 class="text-3xl font-bold mb-2">Welcome to #${channelName}!</h1>
                        <p class="text-[#B5BAC1]">This is the start of the #${channelName} channel.</p>
                    </div>
                `;
                return;
            }

            // Wrapper to push messages to bottom
            let html = '<div class="flex-1"></div>';

            msgs.forEach((msg, index) => {
                const prevMsg = msgs[index - 1];
                // Simple check for message grouping (compact mode)
                const isCompact = prevMsg && prevMsg.user === msg.user && (new Date(msg.id).getTime() - new Date(prevMsg.id).getTime() < 60000); // Hacky ID-as-timestamp check for demo

                if (!isCompact) {
                    html += `
                        <div class="group flex pr-4 hover:bg-[#2e3035] -mx-4 px-4 py-0.5 mt-[17px] relative">
                            <div class="mt-0.5 mr-4 cursor-pointer hover:drop-shadow-md">
                                <img src="${msg.avatar}" alt="${msg.user}" class="w-10 h-10 rounded-full hover:opacity-80 transition-opacity">
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center">
                                    <span class="font-medium mr-2 hover:underline cursor-pointer ${msg.role === 'Admin' ? 'text-blue-400' : 'text-white'}">
                                        ${msg.user}
                                    </span>
                                    ${msg.role === 'Bot' ? '<span class="bg-[#5865F2] text-white text-[10px] px-1.5 rounded-[3px] py-[1px] mr-2 flex items-center"><span class="mt-[1px]">BOT</span></span>' : ''}
                                    <span class="text-xs text-[#949BA4] ml-1">${msg.timestamp}</span>
                                </div>
                                <p class="text-[#dbdee1] whitespace-pre-wrap leading-[1.375rem]">${msg.content}</p>
                            </div>
                             <!-- Hover Actions -->
                            <div class="absolute right-4 -mt-2 bg-[#313338] shadow-sm border border-[#26272D] rounded flex items-center p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="smile" class="w-[18px] h-[18px]"></i></div>
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="reply" class="w-[18px] h-[18px]"></i></div>
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="edit-2" class="w-[16px] h-[16px]"></i></div>
                                ${msg.user === 'You' ? `<div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-red-400 hover:text-red-500"><i data-lucide="trash-2" class="w-[16px] h-[16px]"></i></div>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="group flex pr-4 hover:bg-[#2e3035] -mx-4 px-4 py-0.5 mt-0 relative">
                             <div class="w-10 mr-4 text-[10px] text-[#949BA4] opacity-0 group-hover:opacity-100 flex items-center justify-end select-none">
                                ${msg.timestamp.split('at ')[1]}
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-[#dbdee1] whitespace-pre-wrap leading-[1.375rem]">${msg.content}</p>
                            </div>
                            <!-- Hover Actions (Duplicate for compact) -->
                             <div class="absolute right-4 -mt-2 bg-[#313338] shadow-sm border border-[#26272D] rounded flex items-center p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="smile" class="w-[18px] h-[18px]"></i></div>
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="reply" class="w-[18px] h-[18px]"></i></div>
                                <div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-[#B5BAC1] hover:text-[#dbdee1]"><i data-lucide="edit-2" class="w-[16px] h-[16px]"></i></div>
                                ${msg.user === 'You' ? `<div class="p-1 hover:bg-[#404249] rounded cursor-pointer text-red-400 hover:text-red-500"><i data-lucide="trash-2" class="w-[16px] h-[16px]"></i></div>` : ''}
                            </div>
                        </div>
                    `;
                }
            });

            // Add empty div for auto-scrolling
            html += '<div id="scroll-anchor"></div>';
            
            messagesContainer.innerHTML = html;
            
            // Scroll to bottom
            const anchor = document.getElementById('scroll-anchor');
            if (anchor) anchor.scrollIntoView({ behavior: 'smooth' });
        }

        function updateHeader() {
            const channel = CHANNELS.find(c => c.id === state.activeChannelId);
            headerChannelName.textContent = channel.name;
            messageInput.placeholder = `Message #${channel.name}`;
            
            if (channel.id === 'c1') {
                headerTopic.classList.remove('hidden');
                typingIndicator.classList.remove('hidden'); // Demo purposes
            } else {
                headerTopic.classList.add('hidden');
                typingIndicator.classList.add('hidden');
            }
        }

        // --- Actions ---

        function setActiveChannel(id) {
            state.activeChannelId = id;
            renderChannels();
            renderMessages();
            updateHeader();
            lucide.createIcons(); // Re-initialize icons
        }

        function toggleUserList() {
            state.showUserList = !state.showUserList;
            if (state.showUserList) {
                membersSidebar.classList.remove('hidden');
                membersSidebar.classList.add('flex');
                toggleMembersBtn.classList.add('text-white');
            } else {
                membersSidebar.classList.add('hidden');
                membersSidebar.classList.remove('flex');
                toggleMembersBtn.classList.remove('text-white');
            }
        }

        messageForm.onsubmit = (e) => {
            e.preventDefault();
            const text = messageInput.value.trim();
            if (!text) return;

            const newMessage = {
                id: Date.now(),
                user: 'You',
                avatar: 'https://ui-avatars.com/api/?name=You&background=random',
                content: text,
                timestamp: 'Today at ' + new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                role: 'Member'
            };

            if (!state.messages[state.activeChannelId]) {
                state.messages[state.activeChannelId] = [];
            }
            
            state.messages[state.activeChannelId].push(newMessage);
            messageInput.value = '';
            renderMessages();
            lucide.createIcons();
        };

        toggleMembersBtn.onclick = toggleUserList;

        // --- Init ---
        function init() {
            renderChannels();
            renderMembers();
            renderMessages();
            updateHeader();
            lucide.createIcons();
        }

        init();

    </script>
</body>
</html>